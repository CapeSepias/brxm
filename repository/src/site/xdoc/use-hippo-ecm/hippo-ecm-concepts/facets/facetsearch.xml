<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE document PUBLIC
  "-//Apache Software Foundation//DTD XDOC 1.0//EN"
  "http://maven.apache.org/dtd/xdoc_1_0.dtd">
<!--
  Copyright 2007 Hippo

  Licensed under the Apache License, Version 2.0 (the  "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS"
  BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<document>
  <properties>
    <title>Facet Search</title>
  </properties>
  <body>
     <section name="Faceted search / navigation">
      <p>
        Faceted navigation allows the assignment of multiple classifications to an object,
        enabling the classifications to be ordered in multiple ways, rather than a single,
        pre-determined order. This means objects can be navigated to along different
        paths, each based on different classifications or properties of those objects.
      </p>
      <p>
        Hippo Repository supports a faceted representation of physical
        nodes. These representations are again exposed as 'normal' JCR nodes (according to JSR-170 specification), and
        can be used to represent all kinds of data in all kinds of different structures purely
        defined by their meta information. This results in virtual node trees
        providing a faceted navigation. See the
        <a href="../../integrate-hippo-ecm/example.html">example</a> under
        <a href="../../integrate-hippo-ecm/index.html">Integrating Hippo ECM</a>
        for a ready to use demo project creating faceted navigation.
      </p>
       <subsection name="Faceted navigation explained: visual">
         <p>
         Suppose, you have the following physical documents structure (like on filesystem)
         </p>
         <source>
 Folder                       Type      Size      Age
 ------------------------------------------------------------------------
 Pets
 |-- Dogs
 |   |-- dog1                 Dog       Large     Adult
 |   |-- dog2                 Dog       Medium    Adult
 |   |-- dog3                 Dog       Small     Young
 |   `-- dog4                 Dog       Large     Adult
 |-- Rabbits
 |   |-- rabbit1              Rabbit    Large     Young
 |   |-- rabbit2              Rabbit    Large     Old
 |   |-- rabbit3              Rabbit    Small     Young
 `-- Horses
     |-- horse1               Horse     Small     Young
     |-- horse2               Horse     Large     Young
     `-- horse3               Horse     Large     Old
         </source>

         <p>So, for example, we have 4 Dogs, 3 Rabbits and 3 Horses. 3 small animals, 1 medium and 6 large ones. Some old and some young. Now, instead of
         always browsing through the content like it is structured above, some people might want to have a navigation based on
           the <b>type</b> of animal, then on <b>age</b>, and then on <b>size</b>. Suppose you would make a facet search node called 'By-type-age-size'. These people would then
           have a navigation like below</p>
         <source>
 Folder                       Resulset
 ------------------------------------------------------------------------
 By-type-age-size
 |-- Dogs (4)                 4 Dogs
 |   |-- Adult (3)            3 Dogs
 |   |   |-- Large  (2)       2 Dogs
 |   |   `-- Medium (1)       1 Dogs
 |   `-- Young (1)            1 Dog
 |       `-- Small  (1)       1 Dog
 |-- Rabbits (3)              3 Rabbits
 |   |-- Old   (1)            1 Rabbit
 |   |   `-- Large (1)        1 Rabbit
 |   `-- Young (2)            2 Rabbits
 |       |-- Small (1)        1 Rabbit
 |       `-- Large (1)        1 Rabbit
 `-- Horses (3)               3 Horses
     |-- Old  (1)             1 Horse
     |   `-- Large (1)        1 Horse
     `-- Young(2)             2 Horses
         |-- Large (1)        1 Horse
         `-- Small (1)        1 Horse
         </source>

         <p>However, someone else might want to navigate on <b>size</b> and then on <b>type</b>. He is not interested in age at all.
           His navigation would look like :
         </p>
         <source>
 Folder                       Resulset
 ------------------------------------------------------------------------
 By-size-type
 |-- Large (6)                2 Dogs, 2 Rabbits, 2 Horses
 |   |-- Dogs   (2)           2 Dogs
 |   |-- Horses (2)           2 Horses
 |   `-- Rabbits(2)           2 Rabbits
 |-- Medium (1)               1 Dog
 |   |-- Dogs   (1)           1 Dog
 `-- Small (3)                1 Dog, 1 Rabbit, 1 Horse
     |-- Dogs   (1)           1 Dog
     |-- Horses (1)           1 Horse
     `-- Rabbits(1)           1 Rabbit
         </source>
         <p>
           One and the same person can have many multiple faceted navigations, for example the two above combined:
         </p>
         <source>
 Folder                       Resulset
 ------------------------------------------------------------------------
 MyNavigation
 |-- By-type-age-size
 |   |-- Dogs (4)                 4 Dogs
 |   |   |-- Adult (3)            3 Dogs
 |   |   |   |-- Large  (2)       2 Dogs
 |   |   |   `-- Medium (1)       1 Dogs
 |   |   `-- Young (1)            1 Dog
 |   |       `-- Small  (1)       1 Dog
 |   |-- Rabbits (3)              3 Rabbits
 |   |   |-- Old   (1)            1 Rabbit
 |   |   |   `-- Large (1)        1 Rabbit
 |   |   `-- Young (2)            2 Rabbits
 |   |       |-- Small (1)        1 Rabbit
 |   |       `-- Large (1)        1 Rabbit
 |   `-- Horses (3)               3 Horses
 |   |-- Old  (1)                 1 Horse
 |   |   `-- Large (1)            1 Horse
 |   `-- Young(2)                 2 Horses
 |   |-- Large (1)                1 Horse
 |   `-- Small (1)                1 Horse
 `-- By-size-type
     |-- Large (6)                2 Dogs, 2 Rabbits, 2 Horses
     |   |-- Dogs   (2)           2 Dogs
     |   |-- Horses (2)           2 Horses
     |   `-- Rabbits(2)           2 Rabbits
     |-- Medium (1)               1 Dog
     |   |-- Dogs   (1)           1 Dog
     `-- Small (3)                1 Dog, 1 Rabbit, 1 Horse
         |-- Dogs   (1)           1 Dog
         |-- Horses (1)           1 Horse
         `-- Rabbits(1)           1 Rabbit
         </source>
         <p>
           So you can navigate the (possibly unstructured) content in multiple different structured ways, just how you would like
           to navigate.
         </p>
         <p>
           As another example, imagine booking an online air travel ticket in this way. Instead of the regular
           dropdowns you are used to, and date fields, you say: I want to find tickets based on
           'departure from location x, arrival at location y, fly on date, return at date, on price, on company'. You would
           see a navigation of folders with 'all locations' I can depart from, I choose 'London'. Then, below
           London, I see all location I can fly to, I choose 'Amsterdam', then I see available dates, etc etc. You are
           narrowing down the number of results, always see how many results, and easily change a value by navigation through
           another folder.
         </p>
         <p>
           Someone else who might want to book a ticket as well, might be searching for tickets in a completely different way:
           He is a student, and he wants to leave from London, tomorrow, cheapest price, and then the list of possible arrivals.
           All this is possible through faceted navigation.
         </p>
       </subsection>


      <subsection name="How to create a facet search: example">
        <p>
          First of all, you need to define your facets. They are defined by nodes of type <code>hippo:facetsearch</code>.  These nodes will
          form the root of the virtual folder structure. They have the following JCR properties:
        </p>
        <ul>
          <li>
            <b>hippo:queryname</b>
            <br/>
            The name of the query. You can choose any name you like.
          </li>
          <li>
            <b>hippo:docbase</b>
            <br/>
            The UUID of the physical folder whose contents will be used to generate the
            virtual folder. You might choose to have faceted navigation on a subset of the hierarchical physical tree
          </li>
          <li>
            <b>hippo:facets</b>
            <br/>
            This multivalued property contains the names of the properties that will
            comprise the virtual folder structure.
          </li>
        </ul>
      </subsection>

      <subsection name="Screencast">
        <p>
          A screencast demonstrating the faceted navigation features of Hippo ECM can be found in Arj&#233; Cahn's blog
          post <a href="http://blogs.hippo.nl/arje/2007/09/status_update_defining_facets.html">Developers update:
          Defining facets in Hippo Repository 2.0</a>.
        </p>
        <a href="http://blogs.hippo.nl/arje/2007/09/10/Faceted first demo 2.camrec.html">
          <img src="../../images/facets-screenshot.jpg" width="421" height="410" alt="Facets screenshot" />
        </a>
      </subsection>

    </section>
  </body>
</document>