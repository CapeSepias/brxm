<?xml version="1.0" encoding="UTF-8"?>
<sv:node xmlns:sv="http://www.jcp.org/jcr/sv/1.0" sv:name="hst:configurations">
  <sv:property sv:name="jcr:primaryType" sv:type="Name">
    <sv:value>hst:configurations</sv:value>
  </sv:property>
  <sv:node sv:name="hst:default">
    <sv:property sv:name="jcr:primaryType" sv:type="Name">
      <sv:value>hst:configuration</sv:value>
    </sv:property>
    <sv:node sv:name="hst:sitemap">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:sitemap</sv:value>
      </sv:property>
    </sv:node>
    <sv:node sv:name="hst:pages">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:pages</sv:value>
      </sv:property>
    </sv:node>
    <sv:node sv:name="hst:components">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:components</sv:value>
      </sv:property>
    </sv:node>
    <sv:node sv:name="hst:templates">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:templates</sv:value>
      </sv:property>
      <sv:node sv:name="poll.component.ftl">
        <sv:property sv:name="jcr:primaryType" sv:type="Name">
          <sv:value>hst:template</sv:value>
        </sv:property>
        <sv:property sv:name="hst:script" sv:type="String">
          <sv:value>&lt;#assign hst=JspTaglibs["http://www.hippoecm.org/jsp/hst/core"]&gt;

&lt;div id="poll"&gt;
  &lt;h2&gt;Title provided by Freemarker template&lt;/h2&gt;
  &lt;#if pollDocument??&gt;
    &lt;#if pollDocument.poll.text??&gt;
      &lt;h4&gt;${pollDocument.poll.text}&lt;/h4&gt;
    &lt;/#if&gt;
    &lt;span id="noCookieSupportMessage"&gt;The poll cannot be shown because the browser does not support cookies&lt;/span&gt;

    &lt;#-- Render Poll Form if not yet voted (voteSuccess not defined) or voting failed (voteSuccess is false) --&gt;
    &lt;#if !(voteSuccess??) || voteSuccess == false&gt;
      &lt;div id="pollDiv"&gt;
        &lt;#if pollDocument.poll.introduction??&gt;
          &lt;p id=""&gt;${pollDocument.poll.introduction}&lt;/p&gt;
        &lt;/#if&gt;

        &lt;!-- The Poll --&gt;
        &lt;form id="form-poll" method="post" action="&lt;@hst.actionURL /&gt;"&gt;
          &lt;input type="hidden" name="path" value="${path}"/&gt;
          &lt;div&gt;
            &lt;#list pollDocument.poll.options as curOption&gt;
              &lt;div&gt;
                &lt;input id="${curOption.value}" name="option" type="radio" value="${curOption.value}"
                       &lt;#if option?? &amp;&amp; curOption == option&gt;selected="true"&lt;/#if&gt; /&gt;
                &lt;label for="${curOption.value}"&gt;${curOption.label}&lt;/label&gt;
              &lt;/div&gt;
            &lt;/#list&gt;
          &lt;/div&gt;
          &lt;button class="submit" type="submit"&gt;Vote&lt;/button&gt;
          &lt;#if voteSuccess??&gt; &lt;#-- Implies voteSuccess == "false" --&gt;
            &lt;div&gt;Sorry, processing the vote has failed&lt;/div&gt;
          &lt;/#if&gt;
        &lt;/form&gt;
      &lt;/div&gt;
    &lt;/#if&gt;

    &lt;ul id="pollResults" class="poll-results-list"&gt;
      &lt;#list pollVotes.options as curOption&gt;
        &lt;li&gt;
          &lt;div class="poll-graph-bar"&gt;
            &lt;span class="poll-meter" style="width: ${curOption.votesPercentage}%"&gt; &lt;/span&gt;
          &lt;/div&gt;
          &lt;#if curOption.votesCount == 1&gt;
            ${curOption.label} - ${curOption.votesPercentage}% (${curOption.votesCount} vote)
          &lt;#else&gt;
            ${curOption.label} - ${curOption.votesPercentage}% (${curOption.votesCount} votes)
          &lt;/#if&gt;
        &lt;/li&gt;
      &lt;/#list&gt;
    &lt;/ul&gt;

    &lt;script  type="text/javascript"&gt;
      if (&lt;#if voteSuccess?? &amp;&amp; voteSuccess == true&gt;1&lt;#else&gt;0&lt;/#if&gt;) {
        hide("noCookieSupportMessage");
      } else if (checkBrowserSupportsCookies()) {
        hide("noCookieSupportMessage");
        hide("pollResults");
      } else {
        hide("pollDiv");
        hide("pollResults");
      }

      function hide(id) {
        var element = document.getElementById(id);
        element.parentNode.removeChild(element);
      }

      function checkBrowserSupportsCookies() {
        var cookieDate=new Date();
        var cookieString="testCookieSupport"+cookieDate.toUTCString();
        document.cookie="testCookieSupport="+cookieString;
        return document.cookie.length &gt; 0;
      }
    &lt;/script&gt;

  &lt;#else&gt;
    No active poll available
  &lt;/#if&gt;
&lt;/div&gt;</sv:value>
        </sv:property>
      </sv:node>
    </sv:node>
    <sv:node sv:name="hst:sitemenus">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:sitemenus</sv:value>
      </sv:property>
    </sv:node>
    <sv:node sv:name="hst:sitemapitemhandlers">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:sitemapitemhandlers</sv:value>
      </sv:property>
    </sv:node>
    <sv:node sv:name="hst:catalog">
      <sv:property sv:name="jcr:primaryType" sv:type="Name">
        <sv:value>hst:catalog</sv:value>
      </sv:property>
      <sv:node sv:name="poll-catalog">
        <sv:property sv:name="jcr:primaryType" sv:type="Name">
          <sv:value>hst:containeritempackage</sv:value>
        </sv:property>
        <sv:node sv:name="poll">
          <sv:property sv:name="jcr:primaryType" sv:type="Name">
            <sv:value>hst:containeritemcomponent</sv:value>
          </sv:property>
          <sv:property sv:name="hst:componentclassname" sv:type="String">
            <sv:value>org.onehippo.forge.poll.component.PollComponent</sv:value>
          </sv:property>
          <sv:property sv:name="hst:iconpath" sv:type="String">
            <sv:value>resources/poll/catalog-poll.png</sv:value>
          </sv:property>
          <sv:property sv:name="hst:label" sv:type="String">
            <sv:value>Poll</sv:value>
          </sv:property>
          <sv:property sv:name="hst:parameternames" sv:type="String" sv:multiple="true">
            <sv:value>poll-pollCompoundName</sv:value>
            <sv:value>poll-docsPath</sv:value>
            <sv:value>poll-dataPath</sv:value>
            <sv:value>poll-docsClass</sv:value>
          </sv:property>
          <sv:property sv:name="hst:parametervalues" sv:type="String" sv:multiple="true">
            <sv:value>poll:poll</sv:value>
            <sv:value>/</sv:value>
            <sv:value>polldata</sv:value>
            <sv:value>org.onehippo.forge.poll.contentbean.PollDocument</sv:value>
          </sv:property>
          <sv:property sv:name="hst:template" sv:type="String">
            <sv:value>poll.component.ftl</sv:value>
          </sv:property>
          <sv:property sv:name="hst:xtype" sv:type="String">
            <sv:value>HST.Item</sv:value>
          </sv:property>
        </sv:node>
      </sv:node>
    </sv:node>
  </sv:node>
  <sv:node sv:name="polldemo-subsite-common">
    <sv:property sv:name="jcr:primaryType" sv:type="Name">
      <sv:value>hst:configuration</sv:value>
    </sv:property>
  </sv:node>
  <sv:node sv:name="polldemo">
    <sv:property sv:name="jcr:primaryType" sv:type="Name">
      <sv:value>hst:configuration</sv:value>
    </sv:property>
  </sv:node>
</sv:node>
