<?xml version="1.0" encoding="UTF-8"?>
<!--
    Copyright 2001-2014 Hippo B.V. (http://www.onehippo.com)

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
    implied.
    See the License for the specific language governing permissions and
    limitations under the License
-->
<!DOCTYPE document PUBLIC
  "-//Apache Software Foundation//DTD XDOC 1.0//EN"
  "http://maven.apache.org/dtd/xdoc_1_0.dtd">
<document>
    <properties>
        <title>Forge Document Wizard - Inject values</title>
    </properties>
    <body>
      <section name="InjectValues">
        <subsection name="Inject values from the wizard dialog into the new document">
          <p>
            New documents in the CMS are created using queries. They can be found in the /console at:
            <source><![CDATA[
/hippo:configuration/hippo:queries/hippo:templates]]></source>
            Usually the 'new-document' query is used to create a new document. And that is the default when using this
            document wizard too. Setting the <code>query</code> property overrides this default. (See the
            <a href="configuration.html">configuration page</a> for instructions.)
          </p>
          <p>
            Whatever value is used on the wizard dialog to create the folder(s) the new document is created in,
            you can use that value as a default value inside the document being created. To inject that value in the
            document you have to adapt the query.
          </p>
        </subsection>
        <subsection name="Use a variable in the creation query">
          <p>
            If you take a look at some defined queries for creating new documents, you will see that there is a multivalued
            String property called <code>hippostd:modify</code>. Here you can define which fields to modify when the
            document is created.
          </p>
          <p>
            The field and the replacement for it must be in two subsequent values of this property. The first must contain
            the name of the field, and the second the name of the variable that contains the value.
            The name of the field must be
            preceded with <code>./</code>. So if the name of your field is <code>myproject:publicationdate</code>, the
            first value must be <code>./myproject:publicationdate</code>. The second value must name the variable that
            contains the value you want to inject.
          </p>
          <p>
            For the two <code>classificationType</code>s of this plugin, these variables can be used.
            <table>
              <tr>
                 <th>classification type</th>
                 <th>variable</th>
              </tr>
              <tr>
                 <td>date</td>
                 <td>$date</td>
              </tr>
              <tr>
                 <td>list</td>
                 <td>$list</td>
              </tr>
            </table>
          </p>
        </subsection>
        <subsection name="Scenario">
          <h4>Step 1: use a custom query</h4>
          <img src="screenshots/customquery.png" /><br/>
          The shortcut definition defines a query property to override the default query.
          <h4>Step 2: use fieldname and variable in the query</h4>
          <img src="screenshots/modifiedquery.png" /><br/>
          In the query, two values are added to the <code>hippostd:modify</code> property. In this case, the date of the
          document will be injected with the value choosen for the date field on the dialog wizard, using the
          <code>$date</code> variable.
          <h4>Step 3: when creating the document, the value in the wizard is injected in the document</h4>
          <img src="screenshots/newnewsdocument.png" /><br/>
          1. Click the dashboard shortcut to open the wizard dialog.<br/>
          2. Give a name and a date<br/>
          <img src="screenshots/newnewsdocument2.png" /><br/>
          3. The date entered is injected into the new document.
        </subsection>
      </section>
    </body>
</document>
